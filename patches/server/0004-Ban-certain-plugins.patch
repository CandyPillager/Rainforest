From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Mariell Hoversholm <proximyst@proximyst.com>
Date: Fri, 17 Jul 2020 21:40:15 +0200
Subject: [PATCH] Ban certain plugins

---
 src/main/java/org/bukkit/craftbukkit/CraftServer.java | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index 42e7c8eb7f9fb5f5759666982443475a08aa3ba3..3e3cf95ff9211711da9dfc0038e7d72f1ba2ccbc 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -15,6 +15,7 @@ import com.mojang.brigadier.tree.CommandNode;
 import com.mojang.brigadier.tree.LiteralCommandNode;
 import com.mojang.serialization.DynamicOps;
 import com.mojang.serialization.Lifecycle;
+import com.proximyst.rainforest.RainforestUtils;
 import io.netty.buffer.ByteBuf;
 import io.netty.buffer.ByteBufOutputStream;
 import io.netty.buffer.Unpooled;
@@ -92,7 +93,6 @@ import net.minecraft.server.PlayerList;
 import net.minecraft.server.RegistryMaterials;
 import net.minecraft.server.RegistryReadOps;
 import net.minecraft.server.ResourceKey;
-import net.minecraft.server.SaveData;
 import net.minecraft.server.ServerCommand;
 import net.minecraft.server.TagsServer;
 import net.minecraft.server.TicketType;
@@ -411,6 +411,12 @@ public final class CraftServer implements Server {
 
         for (Plugin plugin : plugins) {
             if ((!plugin.isEnabled()) && (plugin.getDescription().getLoad() == type)) {
+                // Rainforest start
+                if (RainforestUtils.BANNED_MAIN_CLASSES.contains(plugin.getDescription().getMain())) {
+                    getLogger().warning(plugin.getDescription().getName() + " is unsupported on Rainforest.");
+                    continue;
+                }
+                // Rainforest end
                 enablePlugin(plugin);
             }
         }
