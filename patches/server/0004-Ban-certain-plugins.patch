From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Mariell Hoversholm <proximyst@proximyst.com>
Date: Fri, 17 Jul 2020 21:40:15 +0200
Subject: [PATCH] Ban certain plugins

---
 src/main/java/org/bukkit/craftbukkit/CraftServer.java | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/src/main/java/org/bukkit/craftbukkit/CraftServer.java b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
index b2c3f509df859126e4a6918321d4de57cd08f952..3ab8ec1d21d922e2b78df263fa113efebe65c87a 100644
--- a/src/main/java/org/bukkit/craftbukkit/CraftServer.java
+++ b/src/main/java/org/bukkit/craftbukkit/CraftServer.java
@@ -15,6 +15,7 @@ import com.mojang.brigadier.tree.CommandNode;
 import com.mojang.brigadier.tree.LiteralCommandNode;
 import com.mojang.serialization.DynamicOps;
 import com.mojang.serialization.Lifecycle;
+import com.proximyst.rainforest.RainforestUtils;
 import io.netty.buffer.ByteBuf;
 import io.netty.buffer.ByteBufOutputStream;
 import io.netty.buffer.Unpooled;
@@ -410,6 +411,12 @@ public final class CraftServer implements Server {
 
         for (Plugin plugin : plugins) {
             if ((!plugin.isEnabled()) && (plugin.getDescription().getLoad() == type)) {
+                // Rainforest start
+                if (RainforestUtils.BANNED_MAIN_CLASSES.contains(plugin.getDescription().getMain())) {
+                    getLogger().warning(plugin.getDescription().getName() + " is unsupported on Rainforest.");
+                    continue;
+                }
+                // Rainforest end
                 enablePlugin(plugin);
             }
         }
