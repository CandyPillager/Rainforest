From 0000000000000000000000000000000000000000 Mon Sep 17 00:00:00 2001
From: Mariell Hoversholm <proximyst@proximyst.com>
Date: Sun, 19 Jul 2020 11:54:59 +0200
Subject: [PATCH] Fix PaperMC/Paper#3934

---
 src/main/java/net/minecraft/server/PlayerList.java | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/src/main/java/net/minecraft/server/PlayerList.java b/src/main/java/net/minecraft/server/PlayerList.java
index 7ccd7556b4a047e997dc3937d291e69349c7d0b0..f6120cb260f5a7e3562657a9c74ba7131916c0dd 100644
--- a/src/main/java/net/minecraft/server/PlayerList.java
+++ b/src/main/java/net/minecraft/server/PlayerList.java
@@ -857,8 +857,8 @@ public abstract class PlayerList {
         // entityplayer1.syncInventory();
         entityplayer1.setHealth(entityplayer1.getHealth());
         // Paper start - Fix SPIGOT-5989
-        IBlockData data = worldserver1.getType(blockposition);
         if (flag2 && !isLocAltered) {
+            IBlockData data = worldserver1.getType(blockposition);
             worldserver1.setTypeAndData(blockposition, data.set(BlockRespawnAnchor.a, data.get(BlockRespawnAnchor.a) - 1), 3);
             entityplayer1.playerConnection.sendPacket(new PacketPlayOutNamedSoundEffect(SoundEffects.BLOCK_RESPAWN_ANCHOR_DEPLETE, SoundCategory.BLOCKS, (double) location.getX(), (double) location.getY(), (double) location.getZ(), 1.0F, 1.0F));
         // Paper end
